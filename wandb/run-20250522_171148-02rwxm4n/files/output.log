  0%|                                                                                                                                                               | 0/36 [00:00<?, ?it/s]/home/long/.conda/envs/good_prompt/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [06:10<00:00, 10.28s/it]
{'loss': 1.1953, 'grad_norm': 0.021576203841736273, 'learning_rate': 0.0002, 'epoch': 0.4}
{'loss': 1.0398, 'grad_norm': 0.014174974435299269, 'learning_rate': 0.0002, 'epoch': 0.8}
{'loss': 1.0858, 'grad_norm': 0.01141112733456795, 'learning_rate': 0.0002, 'epoch': 1.2}
{'loss': 0.9893, 'grad_norm': 0.010914303397074263, 'learning_rate': 0.0002, 'epoch': 1.6}
{'loss': 1.0533, 'grad_norm': 0.015371370510227645, 'learning_rate': 0.0002, 'epoch': 2.0}
{'loss': 0.9405, 'grad_norm': 0.010290577387673597, 'learning_rate': 0.0002, 'epoch': 2.4}
{'loss': 0.9492, 'grad_norm': 0.011445108118695918, 'learning_rate': 0.0002, 'epoch': 2.8}
{'train_runtime': 371.5754, 'train_samples_per_second': 6.451, 'train_steps_per_second': 0.097, 'train_loss': 1.0343267520268757, 'epoch': 2.88}
***** train metrics *****
  epoch                    =       2.88
  total_flos               =  3194608GF
  train_loss               =     1.0343
  train_runtime            = 0:06:11.57
  train_samples            =       2250
  train_samples_per_second =      6.451
  train_steps_per_second   =      0.097
2025-05-22 17:18:09,931 - __main__ - INFO - *** Save model ***
INFO:__main__:*** Save model ***
[34m[1mwandb[0m: [33mWARNING[0m The get_url method is deprecated and will be removed in a future release. Please use `run.url` instead.
2025-05-22 17:18:19,861 - __main__ - INFO - Model saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
INFO:__main__:Model saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
2025-05-22 17:18:20,022 - __main__ - INFO - Tokenizer saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
INFO:__main__:Tokenizer saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
2025-05-22 17:18:20,033 - __main__ - INFO - Pushing to hub...
INFO:__main__:Pushing to hub...
No files have been modified since last commit. Skipping to prevent empty commit.
WARNING:huggingface_hub.hf_api:No files have been modified since last commit. Skipping to prevent empty commit.
2025-05-22 17:18:24,515 - __main__ - INFO - *** Training complete! ***
INFO:__main__:*** Training complete! ***
