  0%|                                                                                                                                                               | 0/36 [00:00<?, ?it/s]/home/long/.conda/envs/good_prompt/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [06:13<00:00, 10.38s/it]
{'loss': 1.2641, 'grad_norm': 0.030644795063736893, 'learning_rate': 0.00019375000000000002, 'epoch': 0.4}
{'loss': 1.1033, 'grad_norm': 0.02056545690463116, 'learning_rate': 0.00016250000000000002, 'epoch': 0.8}
{'loss': 1.1153, 'grad_norm': 0.012657325093674308, 'learning_rate': 0.00013125000000000002, 'epoch': 1.2}
{'loss': 1.0063, 'grad_norm': 0.011567885886749016, 'learning_rate': 0.0001, 'epoch': 1.6}
{'loss': 1.0714, 'grad_norm': 0.018492490213210075, 'learning_rate': 6.875e-05, 'epoch': 2.0}
{'loss': 0.9669, 'grad_norm': 0.009902239781555196, 'learning_rate': 3.7500000000000003e-05, 'epoch': 2.4}
{'loss': 0.9815, 'grad_norm': 0.010208077763872826, 'learning_rate': 6.25e-06, 'epoch': 2.8}
{'train_runtime': 375.1698, 'train_samples_per_second': 6.389, 'train_steps_per_second': 0.096, 'train_loss': 1.0706788069672055, 'epoch': 2.88}
***** train metrics *****
  epoch                    =       2.88
  total_flos               =  3194608GF
  train_loss               =     1.0707
  train_runtime            = 0:06:15.16
  train_samples            =       2250
  train_samples_per_second =      6.389
  train_steps_per_second   =      0.096
2025-05-22 17:26:20,172 - __main__ - INFO - *** Save model ***
INFO:__main__:*** Save model ***
[34m[1mwandb[0m: [33mWARNING[0m The get_url method is deprecated and will be removed in a future release. Please use `run.url` instead.
2025-05-22 17:26:29,809 - __main__ - INFO - Model saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
INFO:__main__:Model saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
2025-05-22 17:26:29,978 - __main__ - INFO - Tokenizer saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
INFO:__main__:Tokenizer saved to finetuning-codes/runs/qwen-2.5-7b-alpaca
2025-05-22 17:26:29,989 - __main__ - INFO - Pushing to hub...
INFO:__main__:Pushing to hub...
No files have been modified since last commit. Skipping to prevent empty commit.
WARNING:huggingface_hub.hf_api:No files have been modified since last commit. Skipping to prevent empty commit.
2025-05-22 17:26:34,919 - __main__ - INFO - *** Training complete! ***
INFO:__main__:*** Training complete! ***
